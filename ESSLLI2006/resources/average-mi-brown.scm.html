<html>
<head>
<title>average-mi-brown.scm</title>
<style type="text/css"><!--
.syntax0 {
color: #000000;
}
.syntax1 {
color: #cc0000;
}
.syntax2 {
color: #ff8400;
}
.syntax3 {
color: #6600cc;
}
.syntax4 {
color: #cc6600;
}
.syntax5 {
color: #ff0000;
}
.syntax6 {
color: #9966ff;
}
.syntax7 {
background: #ffffcc;
color: #ff0066;
}
.syntax8 {
color: #006699;
font-weight: bold;
}
.syntax9 {
color: #009966;
font-weight: bold;
}
.syntax10 {
color: #0099ff;
font-weight: bold;
}
.syntax11 {
color: #66ccff;
font-weight: bold;
}
.syntax12 {
color: #02b902;
}
.syntax13 {
color: #ff00cc;
}
.syntax14 {
color: #cc00cc;
}
.syntax15 {
color: #9900cc;
}
.syntax16 {
color: #6600cc;
}
.syntax17 {
color: #0000ff;
}
.syntax18 {
color: #000000;
font-weight: bold;
}
.gutter {
background: #dbdbdb;
color: #000000;
}
.gutterH {
background: #dbdbdb;
color: #990066;
}
--></style>
</head>
<body bgcolor="#ffffff">
<pre><span class="syntax0"><span class="gutter">   1:</span><span class="syntax13">&quot;</span><span class="syntax13">:</span><span class="syntax13">&quot;</span><span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">exec</span><span class="syntax1"> </span><span class="syntax1">mzscheme</span><span class="syntax1"> </span><span class="syntax1">-r</span><span class="syntax1"> </span><span class="syntax1">$0</span><span class="syntax1"> </span><span class="syntax1">&quot;$@&quot;</span>
<span class="gutter">   2:</span>
<span class="gutter">   3:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">----------------------------------------------------</span>
<span class="gutter">   4:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">Filename:</span><span class="syntax1"> </span><span class="syntax1">average-mi.scm</span>
<span class="gutterH">   5:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">Author:</span><span class="syntax1"> </span><span class="syntax1"> </span><span class="syntax1"> </span><span class="syntax1">Damir</span><span class="syntax1"> </span><span class="syntax1">Cavar</span><span class="syntax1"> </span><span class="syntax1">&lt;dcavar@me.com&gt;</span>
<span class="gutter">   6:</span><span class="syntax1">;</span><span class="syntax1">;;</span>
<span class="gutter">   7:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">(C)</span><span class="syntax1"> </span><span class="syntax1">2006</span><span class="syntax1"> </span><span class="syntax1">by</span><span class="syntax1"> </span><span class="syntax1">Damir</span><span class="syntax1"> </span><span class="syntax1">Cavar</span>
<span class="gutter">   8:</span><span class="syntax1">;</span><span class="syntax1">;;</span>
<span class="gutter">   9:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">This</span><span class="syntax1"> </span><span class="syntax1">code</span><span class="syntax1"> </span><span class="syntax1">is</span><span class="syntax1"> </span><span class="syntax1">published</span><span class="syntax1"> </span><span class="syntax1">under</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">restrictive</span><span class="syntax1"> </span><span class="syntax1">GPL!</span>
<span class="gutterH">  10:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">Please</span><span class="syntax1"> </span><span class="syntax1">find</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">text</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">GPL</span><span class="syntax1"> </span><span class="syntax1">here:</span>
<span class="gutter">  11:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">http://www.gnu.org/licenses/gpl.txt</span>
<span class="gutter">  12:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span>
<span class="gutter">  13:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">It</span><span class="syntax1"> </span><span class="syntax1">is</span><span class="syntax1"> </span><span class="syntax1">free</span><span class="syntax1"> </span><span class="syntax1">for</span><span class="syntax1"> </span><span class="syntax1">use,</span><span class="syntax1"> </span><span class="syntax1">change,</span><span class="syntax1"> </span><span class="syntax1">etc.</span><span class="syntax1"> </span><span class="syntax1">as</span><span class="syntax1"> </span><span class="syntax1">long</span><span class="syntax1"> </span><span class="syntax1">as</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">copyright</span>
<span class="gutter">  14:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">note</span><span class="syntax1"> </span><span class="syntax1">above</span><span class="syntax1"> </span><span class="syntax1">is</span><span class="syntax1"> </span><span class="syntax1">included</span><span class="syntax1"> </span><span class="syntax1">in</span><span class="syntax1"> </span><span class="syntax1">any</span><span class="syntax1"> </span><span class="syntax1">modified</span><span class="syntax1"> </span><span class="syntax1">version</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">code.</span>
<span class="gutterH">  15:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span>
<span class="gutter">  16:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">This</span><span class="syntax1"> </span><span class="syntax1">script</span><span class="syntax1"> </span><span class="syntax1">assumes</span><span class="syntax1"> </span><span class="syntax1">that</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">text</span><span class="syntax1"> </span><span class="syntax1">is</span><span class="syntax1"> </span><span class="syntax1">raw</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">encoded</span><span class="syntax1"> </span><span class="syntax1">in</span><span class="syntax1"> </span><span class="syntax1">UTF8.</span>
<span class="gutter">  17:</span><span class="syntax1">;</span><span class="syntax1">;;</span>
<span class="gutter">  18:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">Functions:</span>
<span class="gutter">  19:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">1.</span><span class="syntax1"> </span><span class="syntax1">The</span><span class="syntax1"> </span><span class="syntax1">text</span><span class="syntax1"> </span><span class="syntax1">file</span><span class="syntax1"> </span><span class="syntax1">is</span><span class="syntax1"> </span><span class="syntax1">loaded</span><span class="syntax1"> </span><span class="syntax1">into</span><span class="syntax1"> </span><span class="syntax1">memory.</span>
<span class="gutterH">  20:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">2.</span><span class="syntax1"> </span><span class="syntax1">Punctuation</span><span class="syntax1"> </span><span class="syntax1">marks</span><span class="syntax1"> </span><span class="syntax1">are</span><span class="syntax1"> </span><span class="syntax1">eliminated</span><span class="syntax1"> </span><span class="syntax1">from</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">text.</span>
<span class="gutter">  21:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">3.</span><span class="syntax1"> </span><span class="syntax1">The</span><span class="syntax1"> </span><span class="syntax1">text</span><span class="syntax1"> </span><span class="syntax1">is</span><span class="syntax1"> </span><span class="syntax1">tokenized.</span>
<span class="gutter">  22:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">4.</span><span class="syntax1"> </span><span class="syntax1">Two</span><span class="syntax1"> </span><span class="syntax1">adjacent</span><span class="syntax1"> </span><span class="syntax1">tokens</span><span class="syntax1"> </span><span class="syntax1">are</span><span class="syntax1"> </span><span class="syntax1">placed</span><span class="syntax1"> </span><span class="syntax1">into</span><span class="syntax1"> </span><span class="syntax1">a</span><span class="syntax1"> </span><span class="syntax1">hash-table</span><span class="syntax1"> </span><span class="syntax1">as</span><span class="syntax1"> </span><span class="syntax1">keys,</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">value</span>
<span class="gutter">  23:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1"> </span><span class="syntax1"> </span><span class="syntax1"> </span><span class="syntax1">is</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">absolute</span><span class="syntax1"> </span><span class="syntax1">frequency</span><span class="syntax1"> </span><span class="syntax1">(i.e.</span><span class="syntax1"> </span><span class="syntax1">count)</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">each</span><span class="syntax1"> </span><span class="syntax1">token</span><span class="syntax1"> </span><span class="syntax1">in</span><span class="syntax1"> </span><span class="syntax1">the</span>
<span class="gutter">  24:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1"> </span><span class="syntax1"> </span><span class="syntax1"> </span><span class="syntax1">text.</span>
<span class="gutterH">  25:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">5.</span><span class="syntax1"> </span><span class="syntax1">Single</span><span class="syntax1"> </span><span class="syntax1">tokens</span><span class="syntax1"> </span><span class="syntax1">are</span><span class="syntax1"> </span><span class="syntax1">placed</span><span class="syntax1"> </span><span class="syntax1">in</span><span class="syntax1"> </span><span class="syntax1">a</span><span class="syntax1"> </span><span class="syntax1">second</span><span class="syntax1"> </span><span class="syntax1">hash-table.</span>
<span class="gutter">  26:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">6.</span><span class="syntax1"> </span><span class="syntax1">Bigrams</span><span class="syntax1"> </span><span class="syntax1">that</span><span class="syntax1"> </span><span class="syntax1">do</span><span class="syntax1"> </span><span class="syntax1">not</span><span class="syntax1"> </span><span class="syntax1">contain</span><span class="syntax1"> </span><span class="syntax1">stopwords</span><span class="syntax1"> </span><span class="syntax1">are</span><span class="syntax1"> </span><span class="syntax1">printed</span><span class="syntax1"> </span><span class="syntax1">out,</span><span class="syntax1"> </span><span class="syntax1">together</span>
<span class="gutter">  27:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1"> </span><span class="syntax1"> </span><span class="syntax1"> </span><span class="syntax1">with</span><span class="syntax1"> </span><span class="syntax1">their</span><span class="syntax1"> </span><span class="syntax1">Mutual</span><span class="syntax1"> </span><span class="syntax1">Information</span><span class="syntax1"> </span><span class="syntax1">score,</span><span class="syntax1"> </span><span class="syntax1">as</span><span class="syntax1"> </span><span class="syntax1">well</span><span class="syntax1"> </span><span class="syntax1">as</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">average</span>
<span class="gutter">  28:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1"> </span><span class="syntax1"> </span><span class="syntax1"> </span><span class="syntax1">left</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">right</span><span class="syntax1"> </span><span class="syntax1">Mutual</span><span class="syntax1"> </span><span class="syntax1">Information</span><span class="syntax1"> </span><span class="syntax1">score.</span>
<span class="gutter">  29:</span><span class="syntax1">;</span><span class="syntax1">;;</span>
<span class="gutterH">  30:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">If</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">command</span><span class="syntax1"> </span><span class="syntax1">line</span><span class="syntax1"> </span><span class="syntax1">parameters</span><span class="syntax1"> </span><span class="syntax1">contain</span><span class="syntax1"> </span><span class="syntax1">more</span><span class="syntax1"> </span><span class="syntax1">than</span><span class="syntax1"> </span><span class="syntax1">one</span><span class="syntax1"> </span><span class="syntax1">text</span><span class="syntax1"> </span><span class="syntax1">file,</span>
<span class="gutter">  31:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">above</span><span class="syntax1"> </span><span class="syntax1">results</span><span class="syntax1"> </span><span class="syntax1">are</span><span class="syntax1"> </span><span class="syntax1">accumulated</span><span class="syntax1"> </span><span class="syntax1">over</span><span class="syntax1"> </span><span class="syntax1">all</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">input</span><span class="syntax1"> </span><span class="syntax1">text</span><span class="syntax1"> </span><span class="syntax1">files.</span>
<span class="gutter">  32:</span><span class="syntax1">;</span><span class="syntax1">;;</span>
<span class="gutter">  33:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">Usage:</span>
<span class="gutter">  34:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">mzscheme</span><span class="syntax1"> </span><span class="syntax1">-r</span><span class="syntax1"> </span><span class="syntax1">average-mi.scm</span><span class="syntax1"> </span><span class="syntax1">test1.txt</span><span class="syntax1"> </span><span class="syntax1">test2.txt</span><span class="syntax1"> </span><span class="syntax1">...</span>
<span class="gutterH">  35:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">----------------------------------------------------</span>
<span class="gutter">  36:</span>
<span class="gutter">  37:</span>(require (lib <span class="syntax13">&quot;</span><span class="syntax13">list.ss</span><span class="syntax13">&quot;</span>))
<span class="gutter">  38:</span>(require (lib <span class="syntax13">&quot;</span><span class="syntax13">string.ss</span><span class="syntax13">&quot;</span>)) <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">for</span><span class="syntax1"> </span><span class="syntax1">string-uppercase!</span>
<span class="gutter">  39:</span>(require (lib <span class="syntax13">&quot;</span><span class="syntax13">string.ss</span><span class="syntax13">&quot;</span>     <span class="syntax13">&quot;</span><span class="syntax13">srfi</span><span class="syntax13">&quot;</span> <span class="syntax13">&quot;</span><span class="syntax13">13</span><span class="syntax13">&quot;</span>))
<span class="gutterH">  40:</span>(require (lib <span class="syntax13">&quot;</span><span class="syntax13">char-set.ss</span><span class="syntax13">&quot;</span>   <span class="syntax13">&quot;</span><span class="syntax13">srfi</span><span class="syntax13">&quot;</span> <span class="syntax13">&quot;</span><span class="syntax13">14</span><span class="syntax13">&quot;</span>))
<span class="gutter">  41:</span>(require (lib <span class="syntax13">&quot;</span><span class="syntax13">vector-lib.ss</span><span class="syntax13">&quot;</span> <span class="syntax13">&quot;</span><span class="syntax13">srfi</span><span class="syntax13">&quot;</span> <span class="syntax13">&quot;</span><span class="syntax13">43</span><span class="syntax13">&quot;</span>))
<span class="gutter">  42:</span>(require (lib <span class="syntax13">&quot;</span><span class="syntax13">pregexp.ss</span><span class="syntax13">&quot;</span>))  <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">for</span><span class="syntax1"> </span><span class="syntax1">Perl</span><span class="syntax1"> </span><span class="syntax1">compatible</span><span class="syntax1"> </span><span class="syntax1">regular</span><span class="syntax1"> </span><span class="syntax1">expressions</span>
<span class="gutter">  43:</span><span class="syntax1">;</span><span class="syntax1">(load</span><span class="syntax1"> </span><span class="syntax1">&quot;english.ss&quot;)</span>
<span class="gutter">  44:</span>
<span class="gutterH">  45:</span>
<span class="gutter">  46:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">global</span><span class="syntax1"> </span><span class="syntax1">counters</span>
<span class="gutter">  47:</span>(<span class="syntax8">define</span> tokencount  <span class="syntax5">0</span>.<span class="syntax5">0</span>) <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">total</span><span class="syntax1"> </span><span class="syntax1">number</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">words</span>
<span class="gutter">  48:</span>(<span class="syntax8">define</span> bigramcount <span class="syntax5">0</span>.<span class="syntax5">0</span>) <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">total</span><span class="syntax1"> </span><span class="syntax1">number</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">bigrams</span>
<span class="gutter">  49:</span>
<span class="gutterH">  50:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">hash-table</span><span class="syntax1"> </span><span class="syntax1">containers</span>
<span class="gutter">  51:</span>(<span class="syntax8">define</span> types   (make-hash-table <span class="syntax13">'</span><span class="syntax13">equal</span>)) <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">words</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">their</span><span class="syntax1"> </span><span class="syntax1">counts</span>
<span class="gutter">  52:</span>(<span class="syntax8">define</span> tags    (make-hash-table <span class="syntax13">'</span><span class="syntax13">equal</span>))
<span class="gutter">  53:</span>(<span class="syntax8">define</span> bigramstoto (make-hash-table <span class="syntax13">'</span><span class="syntax13">equal</span>)) <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">bigrams</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">their</span><span class="syntax1"> </span><span class="syntax1">counts</span>
<span class="gutter">  54:</span>(<span class="syntax8">define</span> bigramstato (make-hash-table <span class="syntax13">'</span><span class="syntax13">equal</span>)) <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">bigrams</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">their</span><span class="syntax1"> </span><span class="syntax1">counts</span>
<span class="gutterH">  55:</span>(<span class="syntax8">define</span> bigramstata (make-hash-table <span class="syntax13">'</span><span class="syntax13">equal</span>)) <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">bigrams</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">their</span><span class="syntax1"> </span><span class="syntax1">counts</span>
<span class="gutter">  56:</span>(<span class="syntax8">define</span> bigramstota (make-hash-table <span class="syntax13">'</span><span class="syntax13">equal</span>)) <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">bigrams</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">their</span><span class="syntax1"> </span><span class="syntax1">counts</span>
<span class="gutter">  57:</span>
<span class="gutter">  58:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">extra</span><span class="syntax1"> </span><span class="syntax1">hash-tables</span>
<span class="gutter">  59:</span>(<span class="syntax8">define</span> lefttoken  (make-hash-table <span class="syntax13">'</span><span class="syntax13">equal</span>)) <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">key</span><span class="syntax1"> </span><span class="syntax1">=</span><span class="syntax1"> </span><span class="syntax1">left</span><span class="syntax1"> </span><span class="syntax1">token</span><span class="syntax1"> </span><span class="syntax1">in</span><span class="syntax1"> </span><span class="syntax1">bigram,</span><span class="syntax1"> </span><span class="syntax1">value</span><span class="syntax1"> </span><span class="syntax1">=</span><span class="syntax1"> </span><span class="syntax1">list</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">bigrams</span><span class="syntax1"> </span><span class="syntax1">with</span><span class="syntax1"> </span><span class="syntax1">key</span><span class="syntax1"> </span><span class="syntax1">left</span>
<span class="gutterH">  60:</span>(<span class="syntax8">define</span> righttoken (make-hash-table <span class="syntax13">'</span><span class="syntax13">equal</span>)) <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">key</span><span class="syntax1"> </span><span class="syntax1">=</span><span class="syntax1"> </span><span class="syntax1">right</span><span class="syntax1"> </span><span class="syntax1">token</span><span class="syntax1"> </span><span class="syntax1">in</span><span class="syntax1"> </span><span class="syntax1">bigram,</span><span class="syntax1"> </span><span class="syntax1">value</span><span class="syntax1"> </span><span class="syntax1">=</span><span class="syntax1"> </span><span class="syntax1">list</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">bigrams</span><span class="syntax1"> </span><span class="syntax1">with</span><span class="syntax1"> </span><span class="syntax1">key</span><span class="syntax1"> </span><span class="syntax1">right</span>
<span class="gutter">  61:</span>(<span class="syntax8">define</span> lefttag    (make-hash-table <span class="syntax13">'</span><span class="syntax13">equal</span>)) <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">key</span><span class="syntax1"> </span><span class="syntax1">=</span><span class="syntax1"> </span><span class="syntax1">left</span><span class="syntax1"> </span><span class="syntax1">token</span><span class="syntax1"> </span><span class="syntax1">in</span><span class="syntax1"> </span><span class="syntax1">bigram,</span><span class="syntax1"> </span><span class="syntax1">value</span><span class="syntax1"> </span><span class="syntax1">=</span><span class="syntax1"> </span><span class="syntax1">list</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">bigrams</span><span class="syntax1"> </span><span class="syntax1">with</span><span class="syntax1"> </span><span class="syntax1">key</span><span class="syntax1"> </span><span class="syntax1">left</span>
<span class="gutter">  62:</span>(<span class="syntax8">define</span> righttag   (make-hash-table <span class="syntax13">'</span><span class="syntax13">equal</span>)) <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">key</span><span class="syntax1"> </span><span class="syntax1">=</span><span class="syntax1"> </span><span class="syntax1">right</span><span class="syntax1"> </span><span class="syntax1">token</span><span class="syntax1"> </span><span class="syntax1">in</span><span class="syntax1"> </span><span class="syntax1">bigram,</span><span class="syntax1"> </span><span class="syntax1">value</span><span class="syntax1"> </span><span class="syntax1">=</span><span class="syntax1"> </span><span class="syntax1">list</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">bigrams</span><span class="syntax1"> </span><span class="syntax1">with</span><span class="syntax1"> </span><span class="syntax1">key</span><span class="syntax1"> </span><span class="syntax1">right</span>
<span class="gutter">  63:</span>(<span class="syntax8">define</span> tags       (make-hash-table <span class="syntax13">'</span><span class="syntax13">equal</span>))
<span class="gutter">  64:</span>
<span class="gutterH">  65:</span>
<span class="gutter">  66:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">sort</span><span class="syntax1"> </span><span class="syntax1">hash</span><span class="syntax1"> </span><span class="syntax1">table</span><span class="syntax1"> </span><span class="syntax1">with</span><span class="syntax1"> </span><span class="syntax1">by</span><span class="syntax1"> </span><span class="syntax1">value</span>
<span class="gutter">  67:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">assuming</span><span class="syntax1"> </span><span class="syntax1">values</span><span class="syntax1"> </span><span class="syntax1">=</span><span class="syntax1"> </span><span class="syntax1">reals/ints</span>
<span class="gutter">  68:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">returning</span><span class="syntax1"> </span><span class="syntax1">a</span><span class="syntax1"> </span><span class="syntax1">sorted</span><span class="syntax1"> </span><span class="syntax1">list</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">key-value</span><span class="syntax1"> </span><span class="syntax1">tuples</span><span class="syntax1"> </span><span class="syntax1">(lists)</span>
<span class="gutter">  69:</span>(<span class="syntax8">define</span> sort-by-value
<span class="gutterH">  70:</span>  (<span class="syntax8">lambda</span> (table)
<span class="gutter">  71:</span>    (<span class="syntax8">let</span> ([keyval (hash-table-map table (<span class="syntax8">lambda</span> (key val) (<span class="syntax9">list</span> key val)))])
<span class="gutter">  72:</span>      (sort keyval (<span class="syntax8">lambda</span> (a b)
<span class="gutter">  73:</span>                     (&lt; (<span class="syntax9">cadr</span> a) (<span class="syntax9">cadr</span> b)))))))
<span class="gutter">  74:</span>
<span class="gutterH">  75:</span>
<span class="gutter">  76:</span>(<span class="syntax8">define</span> add-data
<span class="gutter">  77:</span>  (<span class="syntax8">lambda</span> (tokenlist)
<span class="gutter">  78:</span>    <span class="syntax1">;</span><span class="syntax1">(printf</span><span class="syntax1"> </span><span class="syntax1">&quot;Adding</span><span class="syntax1"> </span><span class="syntax1">tokens</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">tags...\n&quot;)</span>
<span class="gutter">  79:</span>    <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">remember</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">total</span><span class="syntax1"> </span><span class="syntax1">counts</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">tokens</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">bigrams</span>
<span class="gutterH">  80:</span>    (<span class="syntax8">let</span> ([count (- (<span class="syntax9">length</span> tokenlist) <span class="syntax5">1</span>)])
<span class="gutter">  81:</span>      (<span class="syntax8">set!</span> tokencount  (+ tokencount  (<span class="syntax9">length</span> tokenlist)))
<span class="gutter">  82:</span>      (<span class="syntax8">set!</span> bigramcount (+ bigramcount count))
<span class="gutter">  83:</span>
<span class="gutter">  84:</span>      <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">count</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">first</span><span class="syntax1"> </span><span class="syntax1">token</span><span class="syntax1"> </span><span class="syntax1">in</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">list</span>
<span class="gutterH">  85:</span>      (hash-table-put! types (<span class="syntax9">caar</span> tokenlist)
<span class="gutter">  86:</span>                       (+ (hash-table-get types (<span class="syntax9">caar</span> tokenlist) <span class="syntax5">0</span>.<span class="syntax5">0</span>) <span class="syntax5">1</span>))
<span class="gutter">  87:</span>      (hash-table-put! tags (<span class="syntax9">cadar</span> tokenlist)
<span class="gutter">  88:</span>                       (+ (hash-table-get tags (<span class="syntax9">cadar</span> tokenlist) <span class="syntax5">0</span>.<span class="syntax5">0</span>) <span class="syntax5">1</span>))
<span class="gutter">  89:</span>
<span class="gutterH">  90:</span>      <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">loop</span><span class="syntax1"> </span><span class="syntax1">over</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">rest</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">tokens</span>
<span class="gutter">  91:</span>      (<span class="syntax8">let</span> loop ([i <span class="syntax5">1</span>])
<span class="gutter">  92:</span>        (<span class="syntax8">let*</span> ([word     (<span class="syntax9">car</span>  (<span class="syntax9">list-ref</span> tokenlist i))]       <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">right</span><span class="syntax1"> </span><span class="syntax1">token</span>
<span class="gutter">  93:</span>               [wordp    (<span class="syntax9">car</span>  (<span class="syntax9">list-ref</span> tokenlist (- i <span class="syntax5">1</span>)))] <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">left</span><span class="syntax1"> </span><span class="syntax1">token</span>
<span class="gutter">  94:</span>               [tag      (<span class="syntax9">cadr</span> (<span class="syntax9">list-ref</span> tokenlist i))]       <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">tag</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">right</span><span class="syntax1"> </span><span class="syntax1">token</span>
<span class="gutterH">  95:</span>               [tagp     (<span class="syntax9">cadr</span> (<span class="syntax9">list-ref</span> tokenlist (- i <span class="syntax5">1</span>)))] <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">tag</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">left</span><span class="syntax1"> </span><span class="syntax1">token</span>
<span class="gutter">  96:</span>               [bigramtato (<span class="syntax9">list</span> tagp  word)] <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">bigram</span><span class="syntax1"> </span><span class="syntax1">=</span><span class="syntax1"> </span><span class="syntax1">previous</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">current</span><span class="syntax1"> </span><span class="syntax1">token</span><span class="syntax1"> </span><span class="syntax1">as</span><span class="syntax1"> </span><span class="syntax1">list</span>
<span class="gutter">  97:</span>               [bigramtota (<span class="syntax9">list</span> wordp tag)]  <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">bigram</span><span class="syntax1"> </span><span class="syntax1">=</span><span class="syntax1"> </span><span class="syntax1">previous</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">current</span><span class="syntax1"> </span><span class="syntax1">token</span><span class="syntax1"> </span><span class="syntax1">as</span><span class="syntax1"> </span><span class="syntax1">list</span>
<span class="gutter">  98:</span>               [bigramtoto (<span class="syntax9">list</span> wordp word)] <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">bigram</span><span class="syntax1"> </span><span class="syntax1">=</span><span class="syntax1"> </span><span class="syntax1">previous</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">current</span><span class="syntax1"> </span><span class="syntax1">token</span><span class="syntax1"> </span><span class="syntax1">as</span><span class="syntax1"> </span><span class="syntax1">list</span>
<span class="gutter">  99:</span>               [bigramtata (<span class="syntax9">list</span> tagp  tag)])  <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">bigram</span><span class="syntax1"> </span><span class="syntax1">=</span><span class="syntax1"> </span><span class="syntax1">previous</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">current</span><span class="syntax1"> </span><span class="syntax1">token</span><span class="syntax1"> </span><span class="syntax1">as</span><span class="syntax1"> </span><span class="syntax1">list</span>
<span class="gutterH"> 100:</span>
<span class="gutter"> 101:</span>          <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">store</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">bigram</span><span class="syntax1"> </span><span class="syntax1">in</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">value</span><span class="syntax1"> </span><span class="syntax1">for</span><span class="syntax1"> </span><span class="syntax1">left</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">right</span>
<span class="gutter"> 102:</span>          (<span class="syntax8">let</span> ([listval (hash-table-get lefttoken wordp '())])
<span class="gutter"> 103:</span>            (unless (<span class="syntax9">member</span> listval bigramtota)
<span class="gutter"> 104:</span>              (hash-table-put! lefttoken wordp (<span class="syntax9">cons</span> bigramtota listval))))
<span class="gutterH"> 105:</span>          (<span class="syntax8">let</span> ([listval (hash-table-get righttoken word '())])
<span class="gutter"> 106:</span>            (unless (<span class="syntax9">member</span> listval bigramtato)
<span class="gutter"> 107:</span>              (hash-table-put! righttoken word (<span class="syntax9">cons</span> bigramtato listval))))
<span class="gutter"> 108:</span>          
<span class="gutter"> 109:</span>          (<span class="syntax8">let</span> ([listval (hash-table-get lefttag tagp '())])
<span class="gutterH"> 110:</span>            (unless (<span class="syntax9">member</span> listval bigramtato)
<span class="gutter"> 111:</span>              (hash-table-put! lefttag tagp (<span class="syntax9">cons</span> bigramtato listval))))
<span class="gutter"> 112:</span>          (<span class="syntax8">let</span> ([listval (hash-table-get righttag tag '())])
<span class="gutter"> 113:</span>            (unless (<span class="syntax9">member</span> listval bigramtota)
<span class="gutter"> 114:</span>              (hash-table-put! righttag tag (<span class="syntax9">cons</span> bigramtota listval))))
<span class="gutterH"> 115:</span>
<span class="gutter"> 116:</span>          <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">store</span><span class="syntax1"> </span><span class="syntax1">tokens</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">bigrams</span><span class="syntax1"> </span><span class="syntax1">in</span><span class="syntax1"> </span><span class="syntax1">their</span><span class="syntax1"> </span><span class="syntax1">hash-tables</span>
<span class="gutter"> 117:</span>          (hash-table-put! types word
<span class="gutter"> 118:</span>                           (+ (hash-table-get types word <span class="syntax5">0</span>.<span class="syntax5">0</span>) <span class="syntax5">1</span>)) <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">increment</span><span class="syntax1"> </span><span class="syntax1">counter</span><span class="syntax1"> </span><span class="syntax1">for</span><span class="syntax1"> </span><span class="syntax1">token</span>
<span class="gutter"> 119:</span>          (hash-table-put! tags tag
<span class="gutterH"> 120:</span>                           (+ (hash-table-get tags tag <span class="syntax5">0</span>.<span class="syntax5">0</span>) <span class="syntax5">1</span>)) <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">increment</span><span class="syntax1"> </span><span class="syntax1">counter</span><span class="syntax1"> </span><span class="syntax1">for</span><span class="syntax1"> </span><span class="syntax1">token</span>
<span class="gutter"> 121:</span>          
<span class="gutter"> 122:</span>          (hash-table-put! bigramstoto bigramtoto
<span class="gutter"> 123:</span>                           (+ (hash-table-get bigramstoto bigramtoto <span class="syntax5">0</span>.<span class="syntax5">0</span>) <span class="syntax5">1</span>))   <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">increment</span><span class="syntax1"> </span><span class="syntax1">counter</span><span class="syntax1"> </span><span class="syntax1">for</span><span class="syntax1"> </span><span class="syntax1">bigram</span>
<span class="gutter"> 124:</span>          (hash-table-put! bigramstato bigramtato
<span class="gutterH"> 125:</span>                           (+ (hash-table-get bigramstato bigramtato <span class="syntax5">0</span>.<span class="syntax5">0</span>) <span class="syntax5">1</span>))   <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">increment</span><span class="syntax1"> </span><span class="syntax1">counter</span><span class="syntax1"> </span><span class="syntax1">for</span><span class="syntax1"> </span><span class="syntax1">bigram</span>
<span class="gutter"> 126:</span>          (hash-table-put! bigramstota bigramtota
<span class="gutter"> 127:</span>                           (+ (hash-table-get bigramstota bigramtota <span class="syntax5">0</span>.<span class="syntax5">0</span>) <span class="syntax5">1</span>))   <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">increment</span><span class="syntax1"> </span><span class="syntax1">counter</span><span class="syntax1"> </span><span class="syntax1">for</span><span class="syntax1"> </span><span class="syntax1">bigram</span>
<span class="gutter"> 128:</span>          (hash-table-put! bigramstata bigramtata
<span class="gutter"> 129:</span>                           (+ (hash-table-get bigramstata bigramtata <span class="syntax5">0</span>.<span class="syntax5">0</span>) <span class="syntax5">1</span>))   <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">increment</span><span class="syntax1"> </span><span class="syntax1">counter</span><span class="syntax1"> </span><span class="syntax1">for</span><span class="syntax1"> </span><span class="syntax1">bigram</span>
<span class="gutterH"> 130:</span>
<span class="gutter"> 131:</span>        <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">go</span><span class="syntax1"> </span><span class="syntax1">back</span><span class="syntax1"> </span><span class="syntax1">to</span><span class="syntax1"> </span><span class="syntax1">loop,</span><span class="syntax1"> </span><span class="syntax1">if</span><span class="syntax1"> </span><span class="syntax1">more</span><span class="syntax1"> </span><span class="syntax1">tokens</span><span class="syntax1"> </span><span class="syntax1">left</span>
<span class="gutter"> 132:</span>        (<span class="syntax8">if</span> (&lt; i count)
<span class="gutter"> 133:</span>            (loop (+ i <span class="syntax5">1</span>))))))))
<span class="gutter"> 134:</span>
<span class="gutterH"> 135:</span>
<span class="gutter"> 136:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">log2</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">value</span>
<span class="gutter"> 137:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">Base</span><span class="syntax1"> </span><span class="syntax1">transformation:</span>
<span class="gutter"> 138:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1"> </span><span class="syntax1"> </span><span class="syntax1">log2</span><span class="syntax1"> </span><span class="syntax1">is</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">natural</span><span class="syntax1"> </span><span class="syntax1">log</span><span class="syntax1"> </span><span class="syntax1">divided</span><span class="syntax1"> </span><span class="syntax1">by</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">natural</span><span class="syntax1"> </span><span class="syntax1">log</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">2</span><span class="syntax1"> </span><span class="syntax1">(the</span><span class="syntax1"> </span><span class="syntax1">base)</span>
<span class="gutter"> 139:</span>(<span class="syntax8">define</span> log2
<span class="gutterH"> 140:</span>    (<span class="syntax8">lambda</span> (x)
<span class="gutter"> 141:</span>      (/ (<span class="syntax9">log</span> x) (<span class="syntax9">log</span> <span class="syntax5">2</span>))))
<span class="gutter"> 142:</span>
<span class="gutter"> 143:</span>
<span class="gutter"> 144:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">mutual-information</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">P(x),</span><span class="syntax1"> </span><span class="syntax1">P(y),</span><span class="syntax1"> </span><span class="syntax1">P(xy)</span>
<span class="gutterH"> 145:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">calculate</span><span class="syntax1"> </span><span class="syntax1">pointwise</span><span class="syntax1"> </span><span class="syntax1">MI</span><span class="syntax1"> </span><span class="syntax1">as</span>
<span class="gutter"> 146:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">P(XY)</span><span class="syntax1"> </span><span class="syntax1">*</span><span class="syntax1"> </span><span class="syntax1">log2(</span><span class="syntax1"> </span><span class="syntax1">P(XY)</span><span class="syntax1"> </span><span class="syntax1">/</span><span class="syntax1"> </span><span class="syntax1">(P(X)</span><span class="syntax1"> </span><span class="syntax1">*</span><span class="syntax1"> </span><span class="syntax1">P(Y))</span><span class="syntax1"> </span><span class="syntax1">)</span>
<span class="gutter"> 147:</span>(<span class="syntax8">define</span> mutual-information
<span class="gutter"> 148:</span>  (<span class="syntax8">lambda</span> (px py pxy)
<span class="gutter"> 149:</span>    (* pxy (log2 (/ pxy (* px py))))))
<span class="gutterH"> 150:</span>
<span class="gutter"> 151:</span>
<span class="gutter"> 152:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">load-file</span><span class="syntax1"> </span><span class="syntax1">(filename)</span>
<span class="gutter"> 153:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">load</span><span class="syntax1"> </span><span class="syntax1">text</span><span class="syntax1"> </span><span class="syntax1">from</span><span class="syntax1"> </span><span class="syntax1">file</span><span class="syntax1"> </span><span class="syntax1">into</span><span class="syntax1"> </span><span class="syntax1">a</span><span class="syntax1"> </span><span class="syntax1">string</span><span class="syntax1"> </span><span class="syntax1">variable</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">return</span><span class="syntax1"> </span><span class="syntax1">it</span>
<span class="gutter"> 154:</span>(<span class="syntax8">define</span> load-file
<span class="gutterH"> 155:</span>  (<span class="syntax8">lambda</span> (name)
<span class="gutter"> 156:</span>    (<span class="syntax9">call-with-input-file</span> name
<span class="gutter"> 157:</span>      (<span class="syntax8">lambda</span> (p)
<span class="gutter"> 158:</span>        (read-string (file-size name) p)))))
<span class="gutter"> 159:</span>
<span class="gutterH"> 160:</span>
<span class="gutter"> 161:</span><span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">MI</span><span class="syntax1"> </span><span class="syntax1">for</span><span class="syntax1"> </span><span class="syntax1">token=word</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">tags</span><span class="syntax1"> </span><span class="syntax1">in</span><span class="syntax1"> </span><span class="syntax1">context</span>
<span class="gutter"> 162:</span>(<span class="syntax8">define</span> get-average-lrmi-tag
<span class="gutter"> 163:</span>  (<span class="syntax8">lambda</span> (token)
<span class="gutter"> 164:</span>    (<span class="syntax8">let</span> ([avleft  <span class="syntax5">0</span>.<span class="syntax5">0</span>]
<span class="gutterH"> 165:</span>          [avright <span class="syntax5">0</span>.<span class="syntax5">0</span>]
<span class="gutter"> 166:</span>          [px      (/ (hash-table-get types token <span class="syntax5">0</span>.<span class="syntax5">0</span>) tokencount)])
<span class="gutter"> 167:</span>      <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">for</span><span class="syntax1"> </span><span class="syntax1">all</span><span class="syntax1"> </span><span class="syntax1">bigrams</span><span class="syntax1"> </span><span class="syntax1">with</span><span class="syntax1"> </span><span class="syntax1">token</span><span class="syntax1"> </span><span class="syntax1">left,</span><span class="syntax1"> </span><span class="syntax1">get</span><span class="syntax1"> </span><span class="syntax1">MI</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">average</span><span class="syntax1"> </span><span class="syntax1">it</span>
<span class="gutter"> 168:</span>      (<span class="syntax8">let*</span> ([val    (hash-table-get lefttoken token '())]
<span class="gutter"> 169:</span>             [lenval (<span class="syntax9">length</span> val)])
<span class="gutterH"> 170:</span>        (<span class="syntax9">for-each</span> (<span class="syntax8">lambda</span> (bigram)
<span class="gutter"> 171:</span>                    (<span class="syntax8">let</span> ([py  (/ (hash-table-get tags (<span class="syntax9">cadr</span> bigram) <span class="syntax5">0</span>.<span class="syntax5">0</span>) tokencount)]
<span class="gutter"> 172:</span>                          [pxy (/ (hash-table-get bigramstota bigram <span class="syntax5">0</span>.<span class="syntax5">0</span>) bigramcount)])
<span class="gutter"> 173:</span>                      (<span class="syntax8">set!</span> avright (+ avright (mutual-information px py pxy)))))
<span class="gutter"> 174:</span>                  val)
<span class="gutterH"> 175:</span>        (unless (= <span class="syntax5">0</span> lenval)
<span class="gutter"> 176:</span>          (<span class="syntax8">set!</span> avright (/ avright lenval))))
<span class="gutter"> 177:</span>      <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">for</span><span class="syntax1"> </span><span class="syntax1">all</span><span class="syntax1"> </span><span class="syntax1">bigrams</span><span class="syntax1"> </span><span class="syntax1">with</span><span class="syntax1"> </span><span class="syntax1">token</span><span class="syntax1"> </span><span class="syntax1">right,</span><span class="syntax1"> </span><span class="syntax1">get</span><span class="syntax1"> </span><span class="syntax1">MI</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">average</span><span class="syntax1"> </span><span class="syntax1">it</span>
<span class="gutter"> 178:</span>      (<span class="syntax8">let*</span> ([val    (hash-table-get righttoken token '())]
<span class="gutter"> 179:</span>             [lenval (<span class="syntax9">length</span> val)])
<span class="gutterH"> 180:</span>        (<span class="syntax9">for-each</span> (<span class="syntax8">lambda</span> (bigram)
<span class="gutter"> 181:</span>                    (<span class="syntax8">let</span> ([py  (/ (hash-table-get tags (<span class="syntax9">car</span> bigram) <span class="syntax5">0</span>.<span class="syntax5">0</span>) tokencount)]
<span class="gutter"> 182:</span>                          [pxy (/ (hash-table-get bigramstato bigram <span class="syntax5">0</span>.<span class="syntax5">0</span>) bigramcount)])
<span class="gutter"> 183:</span>                      (<span class="syntax8">set!</span> avleft (+ avleft (mutual-information px py pxy)))))
<span class="gutter"> 184:</span>                  val)
<span class="gutterH"> 185:</span>        (unless (= <span class="syntax5">0</span> lenval)
<span class="gutter"> 186:</span>          (<span class="syntax8">set!</span> avleft (/ avleft (<span class="syntax9">length</span> val)))))
<span class="gutter"> 187:</span>      (<span class="syntax9">list</span> avleft avright))))
<span class="gutter"> 188:</span>
<span class="gutter"> 189:</span>
<span class="gutterH"> 190:</span>
<span class="gutter"> 191:</span><span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">MI</span><span class="syntax1"> </span><span class="syntax1">for</span><span class="syntax1"> </span><span class="syntax1">token=tag</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">words</span><span class="syntax1"> </span><span class="syntax1">in</span><span class="syntax1"> </span><span class="syntax1">context</span>
<span class="gutter"> 192:</span>(<span class="syntax8">define</span> get-average-lrmi-token
<span class="gutter"> 193:</span>  (<span class="syntax8">lambda</span> (token)
<span class="gutter"> 194:</span>    (<span class="syntax8">let</span> ([avleft  <span class="syntax5">0</span>.<span class="syntax5">0</span>]
<span class="gutterH"> 195:</span>          [avright <span class="syntax5">0</span>.<span class="syntax5">0</span>]
<span class="gutter"> 196:</span>          [px      (/ (hash-table-get tags token <span class="syntax5">0</span>.<span class="syntax5">0</span>) tokencount)])
<span class="gutter"> 197:</span>      <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">for</span><span class="syntax1"> </span><span class="syntax1">all</span><span class="syntax1"> </span><span class="syntax1">bigrams</span><span class="syntax1"> </span><span class="syntax1">with</span><span class="syntax1"> </span><span class="syntax1">token</span><span class="syntax1"> </span><span class="syntax1">left,</span><span class="syntax1"> </span><span class="syntax1">get</span><span class="syntax1"> </span><span class="syntax1">MI</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">average</span><span class="syntax1"> </span><span class="syntax1">it</span>
<span class="gutter"> 198:</span>      (<span class="syntax8">let*</span> ([val    (hash-table-get lefttag token '())]
<span class="gutter"> 199:</span>             [lenval (<span class="syntax9">length</span> val)])
<span class="gutterH"> 200:</span>        (<span class="syntax9">for-each</span> (<span class="syntax8">lambda</span> (bigram)
<span class="gutter"> 201:</span>                    (<span class="syntax8">let</span> ([py  (/ (hash-table-get types (<span class="syntax9">cadr</span> bigram) <span class="syntax5">0</span>.<span class="syntax5">0</span>) tokencount)]
<span class="gutter"> 202:</span>                          [pxy (/ (hash-table-get bigramstato bigram <span class="syntax5">0</span>.<span class="syntax5">0</span>) bigramcount)])
<span class="gutter"> 203:</span>                      (<span class="syntax8">set!</span> avright (+ avright (mutual-information px py pxy)))))
<span class="gutter"> 204:</span>                  val)
<span class="gutterH"> 205:</span>        (unless (= <span class="syntax5">0</span> lenval)
<span class="gutter"> 206:</span>          (<span class="syntax8">set!</span> avright (/ avright lenval))))
<span class="gutter"> 207:</span>      <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">for</span><span class="syntax1"> </span><span class="syntax1">all</span><span class="syntax1"> </span><span class="syntax1">bigrams</span><span class="syntax1"> </span><span class="syntax1">with</span><span class="syntax1"> </span><span class="syntax1">token</span><span class="syntax1"> </span><span class="syntax1">right,</span><span class="syntax1"> </span><span class="syntax1">get</span><span class="syntax1"> </span><span class="syntax1">MI</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">average</span><span class="syntax1"> </span><span class="syntax1">it</span>
<span class="gutter"> 208:</span>      (<span class="syntax8">let*</span> ([val    (hash-table-get righttag token '())]
<span class="gutter"> 209:</span>             [lenval (<span class="syntax9">length</span> val)])
<span class="gutterH"> 210:</span>        (<span class="syntax9">for-each</span> (<span class="syntax8">lambda</span> (bigram)
<span class="gutter"> 211:</span>                    (<span class="syntax8">let</span> ([py  (/ (hash-table-get types (<span class="syntax9">car</span> bigram) <span class="syntax5">0</span>.<span class="syntax5">0</span>) tokencount)]
<span class="gutter"> 212:</span>                          [pxy (/ (hash-table-get bigramstota bigram <span class="syntax5">0</span>.<span class="syntax5">0</span>) bigramcount)])
<span class="gutter"> 213:</span>                      (<span class="syntax8">set!</span> avleft (+ avleft (mutual-information px py pxy)))))
<span class="gutter"> 214:</span>                  val)
<span class="gutterH"> 215:</span>        (unless (= <span class="syntax5">0</span> lenval)
<span class="gutter"> 216:</span>          (<span class="syntax8">set!</span> avleft (/ avleft (<span class="syntax9">length</span> val)))))
<span class="gutter"> 217:</span>      (<span class="syntax9">list</span> avleft avright))))
<span class="gutter"> 218:</span>
<span class="gutter"> 219:</span>
<span class="gutterH"> 220:</span>
<span class="gutter"> 221:</span><span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">split</span><span class="syntax1"> </span><span class="syntax1">token</span><span class="syntax1"> </span><span class="syntax1">into</span><span class="syntax1"> </span><span class="syntax1">list</span><span class="syntax1"> </span><span class="syntax1">with</span><span class="syntax1"> </span><span class="syntax1">(word</span><span class="syntax1"> </span><span class="syntax1">tag)</span>
<span class="gutter"> 222:</span>(<span class="syntax8">define</span> prepare-brown
<span class="gutter"> 223:</span>  (<span class="syntax8">lambda</span> (tokens)
<span class="gutter"> 224:</span>    (<span class="syntax9">map</span> (<span class="syntax8">lambda</span> (token)
<span class="gutterH"> 225:</span>           (<span class="syntax9">list</span> (<span class="syntax9">substring</span> token <span class="syntax5">0</span> (string-index token <span class="syntax13">#\</span><span class="syntax13">/</span>))
<span class="gutter"> 226:</span>                 (<span class="syntax9">substring</span> token (+ (string-index token <span class="syntax13">#\</span><span class="syntax13">/</span>) <span class="syntax5">1</span>))))
<span class="gutter"> 227:</span>         tokens)))
<span class="gutter"> 228:</span>
<span class="gutter"> 229:</span>
<span class="gutterH"> 230:</span>
<span class="gutter"> 231:</span>(<span class="syntax8">begin</span>
<span class="gutter"> 232:</span>  (vector-for-each (<span class="syntax8">lambda</span> (i fname)
<span class="gutter"> 233:</span>                     (printf <span class="syntax13">&quot;</span><span class="syntax13">Processing</span><span class="syntax13"> </span><span class="syntax13">file</span><span class="syntax13"> </span><span class="syntax13">~a</span><span class="syntax13"> </span><span class="syntax13">(~a</span><span class="syntax13"> </span><span class="syntax13">of</span><span class="syntax13"> </span><span class="syntax13">~a)\n</span><span class="syntax13">&quot;</span> fname (+ i <span class="syntax5">1</span>) (<span class="syntax9">vector-length</span> argv))
<span class="gutter"> 234:</span>                     (<span class="syntax8">let</span> ([text (load-file fname)])
<span class="gutterH"> 235:</span>                       (string-lowercase! text)
<span class="gutter"> 236:</span>                       (add-data (prepare-brown (string-tokenize text)))))
<span class="gutter"> 237:</span>                   argv)
<span class="gutter"> 238:</span>  
<span class="gutter"> 239:</span>  
<span class="gutterH"> 240:</span>  (<span class="syntax8">let</span> ([result (sort-by-value types)])
<span class="gutter"> 241:</span>    (printf <span class="syntax13">&quot;</span><span class="syntax13">token\tfreq\tlMI\tlvMI\trMI\trvMI\n</span><span class="syntax13">&quot;</span>)
<span class="gutter"> 242:</span>    (<span class="syntax9">for-each</span> (<span class="syntax8">lambda</span> (token)
<span class="gutter"> 243:</span>                (<span class="syntax8">let</span> ([MI (get-average-lrmi-tag (<span class="syntax9">car</span> token))])
<span class="gutter"> 244:</span>                  (printf <span class="syntax13">&quot;</span><span class="syntax13">~a\t~a\t~a\t~a\t~a\t~a\n</span><span class="syntax13">&quot;</span>
<span class="gutterH"> 245:</span>                          (<span class="syntax9">car</span> token)
<span class="gutter"> 246:</span>                          (/ (<span class="syntax9">cadr</span> token) tokencount)
<span class="gutter"> 247:</span>                          (<span class="syntax8">if</span> (&lt; (<span class="syntax9">car</span> MI) (<span class="syntax9">cadr</span> MI))
<span class="gutter"> 248:</span>                              <span class="syntax13">&quot;</span><span class="syntax13">-</span><span class="syntax13">&quot;</span>
<span class="gutter"> 249:</span>                              <span class="syntax13">&quot;</span><span class="syntax13">+</span><span class="syntax13">&quot;</span>)
<span class="gutterH"> 250:</span>                          (<span class="syntax9">car</span> MI)
<span class="gutter"> 251:</span>                          (<span class="syntax8">if</span> (&lt; (<span class="syntax9">cadr</span> MI) (<span class="syntax9">car</span> MI))
<span class="gutter"> 252:</span>                              <span class="syntax13">&quot;</span><span class="syntax13">-</span><span class="syntax13">&quot;</span>
<span class="gutter"> 253:</span>                              <span class="syntax13">&quot;</span><span class="syntax13">+</span><span class="syntax13">&quot;</span>)
<span class="gutter"> 254:</span>                          (<span class="syntax9">cadr</span> MI))))
<span class="gutterH"> 255:</span>              (<span class="syntax9">reverse</span> result)))
<span class="gutter"> 256:</span>  (printf <span class="syntax13">&quot;</span><span class="syntax13">---------------------------------------------------------\n</span><span class="syntax13">&quot;</span>)
<span class="gutter"> 257:</span>  (printf <span class="syntax13">&quot;</span><span class="syntax13">Number</span><span class="syntax13"> </span><span class="syntax13">of</span><span class="syntax13"> </span><span class="syntax13">tokens:</span><span class="syntax13"> </span><span class="syntax13">~a\n</span><span class="syntax13">&quot;</span>  tokencount)
<span class="gutter"> 258:</span>  (printf <span class="syntax13">&quot;</span><span class="syntax13">Number</span><span class="syntax13"> </span><span class="syntax13">of</span><span class="syntax13"> </span><span class="syntax13">types:</span><span class="syntax13"> </span><span class="syntax13">~a\n</span><span class="syntax13">&quot;</span>   (hash-table-count types))
<span class="gutter"> 259:</span>  (printf <span class="syntax13">&quot;</span><span class="syntax13">Type/Token</span><span class="syntax13"> </span><span class="syntax13">ratio:</span><span class="syntax13"> </span><span class="syntax13">~a\n</span><span class="syntax13">&quot;</span>  (/ (hash-table-count types) tokencount))
<span class="gutterH"> 260:</span>  (printf <span class="syntax13">&quot;</span><span class="syntax13">Number</span><span class="syntax13"> </span><span class="syntax13">of</span><span class="syntax13"> </span><span class="syntax13">bigrams:</span><span class="syntax13"> </span><span class="syntax13">~a\n</span><span class="syntax13">&quot;</span> bigramcount)
<span class="gutter"> 261:</span>  (printf <span class="syntax13">&quot;</span><span class="syntax13">Number</span><span class="syntax13"> </span><span class="syntax13">of</span><span class="syntax13"> </span><span class="syntax13">bigram</span><span class="syntax13"> </span><span class="syntax13">types:</span><span class="syntax13"> </span><span class="syntax13">~a\n</span><span class="syntax13">&quot;</span> (hash-table-count bigramstoto))
<span class="gutter"> 262:</span>  (printf <span class="syntax13">&quot;</span><span class="syntax13">Bigram</span><span class="syntax13"> </span><span class="syntax13">type/token</span><span class="syntax13"> </span><span class="syntax13">ratio:</span><span class="syntax13"> </span><span class="syntax13">~a\n</span><span class="syntax13">&quot;</span>  (/ (hash-table-count bigramstoto) bigramcount))
<span class="gutter"> 263:</span>  (printf <span class="syntax13">&quot;</span><span class="syntax13">---------------------------------------------------------\n</span><span class="syntax13">&quot;</span>)
<span class="gutter"> 264:</span>  (<span class="syntax8">let</span> ([result (sort-by-value tags)])
<span class="gutterH"> 265:</span>    (printf <span class="syntax13">&quot;</span><span class="syntax13">Number</span><span class="syntax13"> </span><span class="syntax13">of</span><span class="syntax13"> </span><span class="syntax13">tags:</span><span class="syntax13"> </span><span class="syntax13">~a\n</span><span class="syntax13">&quot;</span>   (hash-table-count tags))
<span class="gutter"> 266:</span>    (printf <span class="syntax13">&quot;</span><span class="syntax13">token\tfreq\tlMI\tlvMI\trMI\trvMI\n</span><span class="syntax13">&quot;</span>)
<span class="gutter"> 267:</span>    (<span class="syntax9">for-each</span> (<span class="syntax8">lambda</span> (token)
<span class="gutter"> 268:</span>                (<span class="syntax8">let</span> ([MI (get-average-lrmi-token (<span class="syntax9">car</span> token))])
<span class="gutter"> 269:</span>                  (printf <span class="syntax13">&quot;</span><span class="syntax13">~a\t~a\t~a\t~a\t~a\t~a\n</span><span class="syntax13">&quot;</span>
<span class="gutterH"> 270:</span>                          (<span class="syntax9">car</span> token)
<span class="gutter"> 271:</span>                          (/ (<span class="syntax9">cadr</span> token) tokencount)
<span class="gutter"> 272:</span>                          (<span class="syntax8">if</span> (&lt; (<span class="syntax9">car</span> MI) (<span class="syntax9">cadr</span> MI))
<span class="gutter"> 273:</span>                              <span class="syntax13">&quot;</span><span class="syntax13">-</span><span class="syntax13">&quot;</span>
<span class="gutter"> 274:</span>                              <span class="syntax13">&quot;</span><span class="syntax13">+</span><span class="syntax13">&quot;</span>)
<span class="gutterH"> 275:</span>                          (<span class="syntax9">car</span> MI)
<span class="gutter"> 276:</span>                          (<span class="syntax8">if</span> (&lt; (<span class="syntax9">cadr</span> MI) (<span class="syntax9">car</span> MI))
<span class="gutter"> 277:</span>                              <span class="syntax13">&quot;</span><span class="syntax13">-</span><span class="syntax13">&quot;</span>
<span class="gutter"> 278:</span>                              <span class="syntax13">&quot;</span><span class="syntax13">+</span><span class="syntax13">&quot;</span>)
<span class="gutter"> 279:</span>                          (<span class="syntax9">cadr</span> MI))))
<span class="gutterH"> 280:</span>              (<span class="syntax9">reverse</span> result)))
<span class="gutter"> 281:</span>  (printf <span class="syntax13">&quot;</span><span class="syntax13">---------------------------------------------------------\n</span><span class="syntax13">&quot;</span>)
<span class="gutter"> 282:</span>  (<span class="syntax8">let</span> ([result (sort-by-value bigramstoto)])
<span class="gutter"> 283:</span>    (printf <span class="syntax13">&quot;</span><span class="syntax13">token\tfreq\tMI\n</span><span class="syntax13">&quot;</span>)
<span class="gutter"> 284:</span>    (<span class="syntax9">for-each</span> (<span class="syntax8">lambda</span> (token)
<span class="gutterH"> 285:</span>                (<span class="syntax8">let*</span> ([bigram (<span class="syntax9">car</span> token)]
<span class="gutter"> 286:</span>                       [MI (mutual-information (/ (hash-table-get types (<span class="syntax9">car</span> bigram)) tokencount)
<span class="gutter"> 287:</span>                                               (/ (hash-table-get types (<span class="syntax9">cadr</span> bigram)) tokencount)
<span class="gutter"> 288:</span>                                               (/ (<span class="syntax9">cadr</span> token) bigramcount))])
<span class="gutter"> 289:</span>                  (printf <span class="syntax13">&quot;</span><span class="syntax13">~a</span><span class="syntax13"> </span><span class="syntax13">~a\t~a\t~a\n</span><span class="syntax13">&quot;</span> (<span class="syntax9">car</span> bigram) (<span class="syntax9">cadr</span> bigram) (/ (<span class="syntax9">cadr</span> token) tokencount) MI)))
<span class="gutterH"> 290:</span>              (<span class="syntax9">reverse</span> result)))
<span class="gutter"> 291:</span>  (printf <span class="syntax13">&quot;</span><span class="syntax13">---------------------------------------------------------\n</span><span class="syntax13">&quot;</span>)
<span class="gutter"> 292:</span>  (<span class="syntax8">let</span> ([result (sort-by-value bigramstota)])
<span class="gutter"> 293:</span>    (printf <span class="syntax13">&quot;</span><span class="syntax13">token\tfreq\tMI\n</span><span class="syntax13">&quot;</span>)
<span class="gutter"> 294:</span>    (<span class="syntax9">for-each</span> (<span class="syntax8">lambda</span> (token)
<span class="gutterH"> 295:</span>                (<span class="syntax8">let*</span> ([bigram (<span class="syntax9">car</span> token)]
<span class="gutter"> 296:</span>                       [MI (mutual-information (/ (hash-table-get types (<span class="syntax9">car</span> bigram)) tokencount)
<span class="gutter"> 297:</span>                                               (/ (hash-table-get tags (<span class="syntax9">cadr</span> bigram)) tokencount)
<span class="gutter"> 298:</span>                                               (/ (<span class="syntax9">cadr</span> token) bigramcount))])
<span class="gutter"> 299:</span>                  (printf <span class="syntax13">&quot;</span><span class="syntax13">~a</span><span class="syntax13"> </span><span class="syntax13">~a\t~a\t~a\n</span><span class="syntax13">&quot;</span> (<span class="syntax9">car</span> bigram) (<span class="syntax9">cadr</span> bigram) (/ (<span class="syntax9">cadr</span> token) tokencount) MI)))
<span class="gutterH"> 300:</span>              (<span class="syntax9">reverse</span> result)))
<span class="gutter"> 301:</span>  (printf <span class="syntax13">&quot;</span><span class="syntax13">---------------------------------------------------------\n</span><span class="syntax13">&quot;</span>)
<span class="gutter"> 302:</span>  (<span class="syntax8">let</span> ([result (sort-by-value bigramstato)])
<span class="gutter"> 303:</span>    (printf <span class="syntax13">&quot;</span><span class="syntax13">token\tfreq\tMI\n</span><span class="syntax13">&quot;</span>)
<span class="gutter"> 304:</span>    (<span class="syntax9">for-each</span> (<span class="syntax8">lambda</span> (token)
<span class="gutterH"> 305:</span>                (<span class="syntax8">let*</span> ([bigram (<span class="syntax9">car</span> token)]
<span class="gutter"> 306:</span>                       [MI (mutual-information (/ (hash-table-get tags (<span class="syntax9">car</span> bigram)) tokencount)
<span class="gutter"> 307:</span>                                               (/ (hash-table-get types (<span class="syntax9">cadr</span> bigram)) tokencount)
<span class="gutter"> 308:</span>                                               (/ (<span class="syntax9">cadr</span> token) bigramcount))])
<span class="gutter"> 309:</span>                  (printf <span class="syntax13">&quot;</span><span class="syntax13">~a</span><span class="syntax13"> </span><span class="syntax13">~a\t~a\t~a\n</span><span class="syntax13">&quot;</span> (<span class="syntax9">car</span> bigram) (<span class="syntax9">cadr</span> bigram) (/ (<span class="syntax9">cadr</span> token) tokencount) MI)))
<span class="gutterH"> 310:</span>              (<span class="syntax9">reverse</span> result)))
<span class="gutter"> 311:</span>  (printf <span class="syntax13">&quot;</span><span class="syntax13">---------------------------------------------------------\n</span><span class="syntax13">&quot;</span>)
<span class="gutter"> 312:</span>  (<span class="syntax8">let</span> ([result (sort-by-value bigramstata)])
<span class="gutter"> 313:</span>    (printf <span class="syntax13">&quot;</span><span class="syntax13">token\tfreq\tMI\n</span><span class="syntax13">&quot;</span>)
<span class="gutter"> 314:</span>    (<span class="syntax9">for-each</span> (<span class="syntax8">lambda</span> (token)
<span class="gutterH"> 315:</span>                (<span class="syntax8">let*</span> ([bigram (<span class="syntax9">car</span> token)]
<span class="gutter"> 316:</span>                       [MI (mutual-information (/ (hash-table-get tags (<span class="syntax9">car</span> bigram)) tokencount)
<span class="gutter"> 317:</span>                                               (/ (hash-table-get tags (<span class="syntax9">cadr</span> bigram)) tokencount)
<span class="gutter"> 318:</span>                                               (/ (<span class="syntax9">cadr</span> token) bigramcount))])
<span class="gutter"> 319:</span>                  (printf <span class="syntax13">&quot;</span><span class="syntax13">~a</span><span class="syntax13"> </span><span class="syntax13">~a\t~a\t~a\n</span><span class="syntax13">&quot;</span> (<span class="syntax9">car</span> bigram) (<span class="syntax9">cadr</span> bigram) (/ (<span class="syntax9">cadr</span> token) tokencount) MI)))
<span class="gutterH"> 320:</span>              (<span class="syntax9">reverse</span> result)))
<span class="gutter"> 321:</span>  )
</span></pre>

<br/>
<br/>
<br/>
<center>
<script type="text/javascript"><!--
google_ad_client = "ca-pub-8896209246743797";
/* HomePage-DC-small */
google_ad_slot = "9466016636";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</center>
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-98557026-1', 'auto');
    ga('send', 'pageview');

</script></body>
</html>

