<html>
<head>
<title>countunibigrams1.scm</title>
<style type="text/css"><!--
.syntax0 {
color: #000000;
}
.syntax1 {
color: #cc0000;
}
.syntax2 {
color: #ff8400;
}
.syntax3 {
color: #6600cc;
}
.syntax4 {
color: #cc6600;
}
.syntax5 {
color: #ff0000;
}
.syntax6 {
color: #9966ff;
}
.syntax7 {
background: #ffffcc;
color: #ff0066;
}
.syntax8 {
color: #006699;
font-weight: bold;
}
.syntax9 {
color: #009966;
font-weight: bold;
}
.syntax10 {
color: #0099ff;
font-weight: bold;
}
.syntax11 {
color: #66ccff;
font-weight: bold;
}
.syntax12 {
color: #02b902;
}
.syntax13 {
color: #ff00cc;
}
.syntax14 {
color: #cc00cc;
}
.syntax15 {
color: #9900cc;
}
.syntax16 {
color: #6600cc;
}
.syntax17 {
color: #0000ff;
}
.syntax18 {
color: #000000;
font-weight: bold;
}
.gutter {
background: #dbdbdb;
color: #000000;
}
.gutterH {
background: #dbdbdb;
color: #990066;
}
--></style>
</head>
<body bgcolor="#ffffff">
<pre><span class="syntax0"><span class="gutter">   1:</span><span class="syntax13">&quot;</span><span class="syntax13">:</span><span class="syntax13">&quot;</span><span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">exec</span><span class="syntax1"> </span><span class="syntax1">mzscheme</span><span class="syntax1"> </span><span class="syntax1">-r</span><span class="syntax1"> </span><span class="syntax1">$0</span><span class="syntax1"> </span><span class="syntax1">&quot;$@&quot;</span>
<span class="gutter">   2:</span>
<span class="gutter">   3:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">----------------------------------------------------</span>
<span class="gutter">   4:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">Filename:</span><span class="syntax1"> </span><span class="syntax1">countunibigrams1.scm</span>
<span class="gutterH">   5:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">Author:</span><span class="syntax1"> </span><span class="syntax1"> </span><span class="syntax1"> </span><span class="syntax1">Damir</span><span class="syntax1"> </span><span class="syntax1">Cavar</span><span class="syntax1"> </span><span class="syntax1">&lt;dcavar@unizd.hr&gt;</span>
<span class="gutter">   6:</span><span class="syntax1">;</span><span class="syntax1">;;</span>
<span class="gutter">   7:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">(C)</span><span class="syntax1"> </span><span class="syntax1">2006</span><span class="syntax1"> </span><span class="syntax1">by</span><span class="syntax1"> </span><span class="syntax1">Damir</span><span class="syntax1"> </span><span class="syntax1">Cavar</span>
<span class="gutter">   8:</span><span class="syntax1">;</span><span class="syntax1">;;</span>
<span class="gutter">   9:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">This</span><span class="syntax1"> </span><span class="syntax1">code</span><span class="syntax1"> </span><span class="syntax1">is</span><span class="syntax1"> </span><span class="syntax1">published</span><span class="syntax1"> </span><span class="syntax1">under</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">restrictive</span><span class="syntax1"> </span><span class="syntax1">GPL!</span>
<span class="gutterH">  10:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">Please</span><span class="syntax1"> </span><span class="syntax1">find</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">text</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">GPL</span><span class="syntax1"> </span><span class="syntax1">here:</span>
<span class="gutter">  11:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">http://www.gnu.org/licenses/gpl.txt</span>
<span class="gutter">  12:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span>
<span class="gutter">  13:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">It</span><span class="syntax1"> </span><span class="syntax1">is</span><span class="syntax1"> </span><span class="syntax1">free</span><span class="syntax1"> </span><span class="syntax1">for</span><span class="syntax1"> </span><span class="syntax1">use,</span><span class="syntax1"> </span><span class="syntax1">change,</span><span class="syntax1"> </span><span class="syntax1">etc.</span><span class="syntax1"> </span><span class="syntax1">as</span><span class="syntax1"> </span><span class="syntax1">long</span><span class="syntax1"> </span><span class="syntax1">as</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">copyright</span>
<span class="gutter">  14:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">note</span><span class="syntax1"> </span><span class="syntax1">above</span><span class="syntax1"> </span><span class="syntax1">is</span><span class="syntax1"> </span><span class="syntax1">included</span><span class="syntax1"> </span><span class="syntax1">in</span><span class="syntax1"> </span><span class="syntax1">any</span><span class="syntax1"> </span><span class="syntax1">modified</span><span class="syntax1"> </span><span class="syntax1">version</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">code.</span>
<span class="gutterH">  15:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span>
<span class="gutter">  16:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">This</span><span class="syntax1"> </span><span class="syntax1">script</span><span class="syntax1"> </span><span class="syntax1">assumes</span><span class="syntax1"> </span><span class="syntax1">that</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">text</span><span class="syntax1"> </span><span class="syntax1">is</span><span class="syntax1"> </span><span class="syntax1">raw</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">encoded</span><span class="syntax1"> </span><span class="syntax1">in</span><span class="syntax1"> </span><span class="syntax1">UTF8.</span>
<span class="gutter">  17:</span><span class="syntax1">;</span><span class="syntax1">;;</span>
<span class="gutter">  18:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">Functions:</span>
<span class="gutter">  19:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">1.</span><span class="syntax1"> </span><span class="syntax1">The</span><span class="syntax1"> </span><span class="syntax1">text</span><span class="syntax1"> </span><span class="syntax1">file</span><span class="syntax1"> </span><span class="syntax1">is</span><span class="syntax1"> </span><span class="syntax1">loaded</span><span class="syntax1"> </span><span class="syntax1">into</span><span class="syntax1"> </span><span class="syntax1">memory.</span>
<span class="gutterH">  20:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">2.</span><span class="syntax1"> </span><span class="syntax1">The</span><span class="syntax1"> </span><span class="syntax1">text</span><span class="syntax1"> </span><span class="syntax1">is</span><span class="syntax1"> </span><span class="syntax1">tokenized,</span><span class="syntax1"> </span><span class="syntax1">i.e.</span><span class="syntax1"> </span><span class="syntax1">converted</span><span class="syntax1"> </span><span class="syntax1">into</span><span class="syntax1"> </span><span class="syntax1">a</span><span class="syntax1"> </span><span class="syntax1">list</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">tokens.</span>
<span class="gutter">  21:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">3.</span><span class="syntax1"> </span><span class="syntax1">Two</span><span class="syntax1"> </span><span class="syntax1">adjacent</span><span class="syntax1"> </span><span class="syntax1">tokens</span><span class="syntax1"> </span><span class="syntax1">are</span><span class="syntax1"> </span><span class="syntax1">placed</span><span class="syntax1"> </span><span class="syntax1">into</span><span class="syntax1"> </span><span class="syntax1">a</span><span class="syntax1"> </span><span class="syntax1">hash-table</span><span class="syntax1"> </span><span class="syntax1">as</span><span class="syntax1"> </span><span class="syntax1">keys,</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">value</span>
<span class="gutter">  22:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1"> </span><span class="syntax1"> </span><span class="syntax1"> </span><span class="syntax1">is</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">absolute</span><span class="syntax1"> </span><span class="syntax1">frequency</span><span class="syntax1"> </span><span class="syntax1">(i.e.</span><span class="syntax1"> </span><span class="syntax1">count)</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">each</span><span class="syntax1"> </span><span class="syntax1">token</span><span class="syntax1"> </span><span class="syntax1">in</span><span class="syntax1"> </span><span class="syntax1">the</span>
<span class="gutter">  23:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1"> </span><span class="syntax1"> </span><span class="syntax1"> </span><span class="syntax1">text.</span>
<span class="gutter">  24:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">4.</span><span class="syntax1"> </span><span class="syntax1">Single</span><span class="syntax1"> </span><span class="syntax1">tokens</span><span class="syntax1"> </span><span class="syntax1">are</span><span class="syntax1"> </span><span class="syntax1">placed</span><span class="syntax1"> </span><span class="syntax1">in</span><span class="syntax1"> </span><span class="syntax1">a</span><span class="syntax1"> </span><span class="syntax1">second</span><span class="syntax1"> </span><span class="syntax1">hash-table.</span>
<span class="gutterH">  25:</span><span class="syntax1">;</span><span class="syntax1">;;</span>
<span class="gutter">  26:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">If</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">command</span><span class="syntax1"> </span><span class="syntax1">line</span><span class="syntax1"> </span><span class="syntax1">parameters</span><span class="syntax1"> </span><span class="syntax1">contain</span><span class="syntax1"> </span><span class="syntax1">more</span><span class="syntax1"> </span><span class="syntax1">than</span><span class="syntax1"> </span><span class="syntax1">one</span><span class="syntax1"> </span><span class="syntax1">text</span><span class="syntax1"> </span><span class="syntax1">file,</span>
<span class="gutter">  27:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">above</span><span class="syntax1"> </span><span class="syntax1">results</span><span class="syntax1"> </span><span class="syntax1">are</span><span class="syntax1"> </span><span class="syntax1">accumulated</span><span class="syntax1"> </span><span class="syntax1">over</span><span class="syntax1"> </span><span class="syntax1">all</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">input</span><span class="syntax1"> </span><span class="syntax1">text</span><span class="syntax1"> </span><span class="syntax1">files.</span>
<span class="gutter">  28:</span><span class="syntax1">;</span><span class="syntax1">;;</span>
<span class="gutter">  29:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">Usage:</span>
<span class="gutterH">  30:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">mzscheme</span><span class="syntax1"> </span><span class="syntax1">-r</span><span class="syntax1"> </span><span class="syntax1">countunibigrams1.scm</span><span class="syntax1"> </span><span class="syntax1">test1.txt</span><span class="syntax1"> </span><span class="syntax1">test2.txt</span><span class="syntax1"> </span><span class="syntax1">...</span>
<span class="gutter">  31:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">----------------------------------------------------</span>
<span class="gutter">  32:</span>
<span class="gutter">  33:</span>
<span class="gutter">  34:</span>(require (lib <span class="syntax13">&quot;</span><span class="syntax13">list.ss</span><span class="syntax13">&quot;</span>))
<span class="gutterH">  35:</span>(require (lib <span class="syntax13">&quot;</span><span class="syntax13">string.ss</span><span class="syntax13">&quot;</span>)) <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">for</span><span class="syntax1"> </span><span class="syntax1">string-uppercase!</span>
<span class="gutter">  36:</span>(require (lib <span class="syntax13">&quot;</span><span class="syntax13">string.ss</span><span class="syntax13">&quot;</span>     <span class="syntax13">&quot;</span><span class="syntax13">srfi</span><span class="syntax13">&quot;</span> <span class="syntax13">&quot;</span><span class="syntax13">13</span><span class="syntax13">&quot;</span>))
<span class="gutter">  37:</span>(require (lib <span class="syntax13">&quot;</span><span class="syntax13">vector-lib.ss</span><span class="syntax13">&quot;</span> <span class="syntax13">&quot;</span><span class="syntax13">srfi</span><span class="syntax13">&quot;</span> <span class="syntax13">&quot;</span><span class="syntax13">43</span><span class="syntax13">&quot;</span>))
<span class="gutter">  38:</span>
<span class="gutter">  39:</span>
<span class="gutterH">  40:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">global</span><span class="syntax1"> </span><span class="syntax1">counters</span>
<span class="gutter">  41:</span>(<span class="syntax8">define</span> tokencount  <span class="syntax5">0</span>.<span class="syntax5">0</span>) <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">total</span><span class="syntax1"> </span><span class="syntax1">number</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">words</span>
<span class="gutter">  42:</span>(<span class="syntax8">define</span> bigramcount <span class="syntax5">0</span>.<span class="syntax5">0</span>) <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">total</span><span class="syntax1"> </span><span class="syntax1">number</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">bigrams</span>
<span class="gutter">  43:</span>
<span class="gutter">  44:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">hash-table</span><span class="syntax1"> </span><span class="syntax1">containers</span>
<span class="gutterH">  45:</span>(<span class="syntax8">define</span> types   (make-hash-table <span class="syntax13">'</span><span class="syntax13">equal</span>)) <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">words</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">their</span><span class="syntax1"> </span><span class="syntax1">counts</span>
<span class="gutter">  46:</span>(<span class="syntax8">define</span> bigrams (make-hash-table <span class="syntax13">'</span><span class="syntax13">equal</span>)) <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">bigrams</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">their</span><span class="syntax1"> </span><span class="syntax1">counts</span>
<span class="gutter">  47:</span>
<span class="gutter">  48:</span>
<span class="gutter">  49:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">sort</span><span class="syntax1"> </span><span class="syntax1">hash</span><span class="syntax1"> </span><span class="syntax1">table</span><span class="syntax1"> </span><span class="syntax1">with</span><span class="syntax1"> </span><span class="syntax1">by</span><span class="syntax1"> </span><span class="syntax1">value</span>
<span class="gutterH">  50:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">assuming</span><span class="syntax1"> </span><span class="syntax1">values</span><span class="syntax1"> </span><span class="syntax1">=</span><span class="syntax1"> </span><span class="syntax1">reals/ints</span>
<span class="gutter">  51:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">returning</span><span class="syntax1"> </span><span class="syntax1">a</span><span class="syntax1"> </span><span class="syntax1">sorted</span><span class="syntax1"> </span><span class="syntax1">list</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">key-value</span><span class="syntax1"> </span><span class="syntax1">tuples</span><span class="syntax1"> </span><span class="syntax1">(lists)</span>
<span class="gutter">  52:</span>(<span class="syntax8">define</span> sort-by-value
<span class="gutter">  53:</span>  (<span class="syntax8">lambda</span> (table)
<span class="gutter">  54:</span>    (<span class="syntax8">let</span> ([keyval (hash-table-map table (<span class="syntax8">lambda</span> (key val) (<span class="syntax9">list</span> key val)))])
<span class="gutterH">  55:</span>      (sort keyval (<span class="syntax8">lambda</span> (a b)
<span class="gutter">  56:</span>                     (&lt; (<span class="syntax9">cadr</span> a) (<span class="syntax9">cadr</span> b)))))))
<span class="gutter">  57:</span>
<span class="gutter">  58:</span>
<span class="gutter">  59:</span>(<span class="syntax8">define</span> add-data
<span class="gutterH">  60:</span>  (<span class="syntax8">lambda</span> (tokenlist)
<span class="gutter">  61:</span>    (<span class="syntax8">let</span> ([count (- (<span class="syntax9">length</span> tokenlist) <span class="syntax5">1</span>)])
<span class="gutter">  62:</span>
<span class="gutter">  63:</span>      <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">remember</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">total</span><span class="syntax1"> </span><span class="syntax1">count</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">tokens</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">bigrams</span>
<span class="gutter">  64:</span>      (<span class="syntax8">set!</span> tokencount  (+ tokencount  (<span class="syntax9">length</span> tokenlist)))
<span class="gutterH">  65:</span>      (<span class="syntax8">set!</span> bigramcount (+ bigramcount count))
<span class="gutter">  66:</span>
<span class="gutter">  67:</span>      <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">count</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">first</span><span class="syntax1"> </span><span class="syntax1">token</span><span class="syntax1"> </span><span class="syntax1">in</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">list</span>
<span class="gutter">  68:</span>      (<span class="syntax8">let</span> ([value (hash-table-get types (<span class="syntax9">car</span> tokenlist) <span class="syntax5">0</span>.<span class="syntax5">0</span>)])
<span class="gutter">  69:</span>        (hash-table-put! types (<span class="syntax9">car</span> tokenlist) (+ value <span class="syntax5">1</span>)))
<span class="gutterH">  70:</span>
<span class="gutter">  71:</span>      <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">loop</span><span class="syntax1"> </span><span class="syntax1">over</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">rest</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">tokens</span>
<span class="gutter">  72:</span>      (<span class="syntax8">let</span> loop ([i <span class="syntax5">1</span>])
<span class="gutter">  73:</span>        (<span class="syntax8">let*</span> ([token  (<span class="syntax9">list-ref</span>       tokenlist i)]              <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">token</span><span class="syntax1"> </span><span class="syntax1">=</span><span class="syntax1"> </span><span class="syntax1">second</span><span class="syntax1"> </span><span class="syntax1">element</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">bigram</span><span class="syntax1"> </span>
<span class="gutter">  74:</span>               [bigram (<span class="syntax9">list</span> (<span class="syntax9">list-ref</span> tokenlist (- i <span class="syntax5">1</span>)) token)] <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">bigram</span><span class="syntax1"> </span><span class="syntax1">=</span><span class="syntax1"> </span><span class="syntax1">previous</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">current</span><span class="syntax1"> </span><span class="syntax1">token</span><span class="syntax1"> </span><span class="syntax1">as</span><span class="syntax1"> </span><span class="syntax1">list</span>
<span class="gutterH">  75:</span>               [wvalue (hash-table-get types   token  <span class="syntax5">0</span>.<span class="syntax5">0</span>)]       <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">get</span><span class="syntax1"> </span><span class="syntax1">value</span><span class="syntax1"> </span><span class="syntax1">for</span><span class="syntax1"> </span><span class="syntax1">token</span>
<span class="gutter">  76:</span>               [bvalue (hash-table-get bigrams bigram <span class="syntax5">0</span>.<span class="syntax5">0</span>)])      <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">get</span><span class="syntax1"> </span><span class="syntax1">value</span><span class="syntax1"> </span><span class="syntax1">for</span><span class="syntax1"> </span><span class="syntax1">bigram</span>
<span class="gutter">  77:</span>          (hash-table-put! types   token  (+ wvalue <span class="syntax5">1</span>))    <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">increment</span><span class="syntax1"> </span><span class="syntax1">counter</span><span class="syntax1"> </span><span class="syntax1">for</span><span class="syntax1"> </span><span class="syntax1">token</span>
<span class="gutter">  78:</span>          (hash-table-put! bigrams bigram (+ bvalue <span class="syntax5">1</span>)))   <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">increment</span><span class="syntax1"> </span><span class="syntax1">counter</span><span class="syntax1"> </span><span class="syntax1">for</span><span class="syntax1"> </span><span class="syntax1">bigram</span>
<span class="gutter">  79:</span>        (<span class="syntax8">if</span> (&lt; i count)
<span class="gutterH">  80:</span>            (loop (+ i <span class="syntax5">1</span>)))))))
<span class="gutter">  81:</span>
<span class="gutter">  82:</span>
<span class="gutter">  83:</span><span class="syntax1">;</span><span class="syntax1">;;</span><span class="syntax1"> </span><span class="syntax1">load</span><span class="syntax1"> </span><span class="syntax1">text</span><span class="syntax1"> </span><span class="syntax1">from</span><span class="syntax1"> </span><span class="syntax1">file</span><span class="syntax1"> </span><span class="syntax1">into</span><span class="syntax1"> </span><span class="syntax1">a</span><span class="syntax1"> </span><span class="syntax1">string</span><span class="syntax1"> </span><span class="syntax1">variable</span><span class="syntax1"> </span><span class="syntax1">and</span><span class="syntax1"> </span><span class="syntax1">return</span><span class="syntax1"> </span><span class="syntax1">it</span>
<span class="gutter">  84:</span>(<span class="syntax8">define</span> load-file
<span class="gutterH">  85:</span>  (<span class="syntax8">lambda</span> (name)
<span class="gutter">  86:</span>      (<span class="syntax9">call-with-input-file</span> name
<span class="gutter">  87:</span>        (<span class="syntax8">lambda</span> (p)
<span class="gutter">  88:</span>          (read-string (file-size name) p)))))
<span class="gutter">  89:</span>
<span class="gutterH">  90:</span>
<span class="gutter">  91:</span>(<span class="syntax8">begin</span> 
<span class="gutter">  92:</span>  (vector-for-each (<span class="syntax8">lambda</span> (i fname)
<span class="gutter">  93:</span>                     <span class="syntax1">;</span><span class="syntax1"> </span><span class="syntax1">(printf</span><span class="syntax1"> </span><span class="syntax1">&quot;Loading</span><span class="syntax1"> </span><span class="syntax1">file:</span><span class="syntax1"> </span><span class="syntax1">~a\n&quot;</span><span class="syntax1"> </span><span class="syntax1">fname)</span>
<span class="gutter">  94:</span>                     (add-data (string-tokenize (load-file fname))))
<span class="gutterH">  95:</span>                   argv)
<span class="gutter">  96:</span>  (<span class="syntax8">let</span> ([result (sort-by-value bigrams)])
<span class="gutter">  97:</span>    (printf <span class="syntax13">&quot;</span><span class="syntax13">token\tabs.</span><span class="syntax13"> </span><span class="syntax13">freq.\trel.</span><span class="syntax13"> </span><span class="syntax13">freq.\n</span><span class="syntax13">&quot;</span>)
<span class="gutter">  98:</span>    (<span class="syntax9">for-each</span> (<span class="syntax8">lambda</span> (a)
<span class="gutter">  99:</span>                (printf <span class="syntax13">&quot;</span><span class="syntax13">~a\t~a\t~a\n</span><span class="syntax13">&quot;</span> (<span class="syntax9">car</span> a) (<span class="syntax9">cadr</span> a) (/ (<span class="syntax9">cadr</span> a) bigramcount)))
<span class="gutterH"> 100:</span>              (<span class="syntax9">reverse</span> result)))
<span class="gutter"> 101:</span>  (printf <span class="syntax13">&quot;</span><span class="syntax13">---------------------------------------------------------\n</span><span class="syntax13">&quot;</span>)
<span class="gutter"> 102:</span>  (printf <span class="syntax13">&quot;</span><span class="syntax13">Number</span><span class="syntax13"> </span><span class="syntax13">of</span><span class="syntax13"> </span><span class="syntax13">tokens:</span><span class="syntax13"> </span><span class="syntax13">~a\n</span><span class="syntax13">&quot;</span>  tokencount)
<span class="gutter"> 103:</span>  (printf <span class="syntax13">&quot;</span><span class="syntax13">Number</span><span class="syntax13"> </span><span class="syntax13">of</span><span class="syntax13"> </span><span class="syntax13">types:</span><span class="syntax13"> </span><span class="syntax13">~a\n</span><span class="syntax13">&quot;</span>   (hash-table-count types))
<span class="gutter"> 104:</span>  (printf <span class="syntax13">&quot;</span><span class="syntax13">Type/Token</span><span class="syntax13"> </span><span class="syntax13">ratio:</span><span class="syntax13"> </span><span class="syntax13">~a\n</span><span class="syntax13">&quot;</span>  (/ (hash-table-count types) tokencount))
<span class="gutterH"> 105:</span>  (printf <span class="syntax13">&quot;</span><span class="syntax13">Number</span><span class="syntax13"> </span><span class="syntax13">of</span><span class="syntax13"> </span><span class="syntax13">bigrams:</span><span class="syntax13"> </span><span class="syntax13">~a\n</span><span class="syntax13">&quot;</span> bigramcount)
<span class="gutter"> 106:</span>  (printf <span class="syntax13">&quot;</span><span class="syntax13">Number</span><span class="syntax13"> </span><span class="syntax13">of</span><span class="syntax13"> </span><span class="syntax13">bigram</span><span class="syntax13"> </span><span class="syntax13">types:</span><span class="syntax13"> </span><span class="syntax13">~a\n</span><span class="syntax13">&quot;</span> (hash-table-count bigrams))
<span class="gutter"> 107:</span>  (printf <span class="syntax13">&quot;</span><span class="syntax13">Bigram</span><span class="syntax13"> </span><span class="syntax13">type/token</span><span class="syntax13"> </span><span class="syntax13">ratio:</span><span class="syntax13"> </span><span class="syntax13">~a\n</span><span class="syntax13">&quot;</span>  (/ (hash-table-count bigrams) bigramcount)))
</span></pre>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-21704386-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script></body>
</html>

